## 3. 核心业务表描述配置

### 3.1 总账模块表描述

#### gl_voucher（凭证主表）

```
表名: gl_voucher
业务描述: 记账凭证主表，存储凭证头信息。每条记录代表一张完整的记账凭证。

关键字段说明:
- pk_voucher: 凭证主键，凭证的唯一标识
- pk_org: 记账组织主键，关联 org_orgs 表
- pk_accountingbook: 核算账簿主键
- vouchkind: 凭证类别（记账凭证/收款凭证/付款凭证）
- num: 凭证号，格式通常为"类别-序号"
- prepareddate: 制单日期
- signdate: 签字日期
- tallydate: 记账日期
- cyear: 会计年度（4位数字）
- cmonth: 会计期间（1-12）
- vouchstatus: 凭证状态（0=暂存, 1=提交, 2=审核, 3=记账）
- dr: 删除标记，0=有效，非0=已删除

注意事项:
- 查询有效凭证时必须加 dr = 0 条件
- 查询已记账凭证需加 vouchstatus >= 3
- 通常需要关联 gl_detail 获取分录明细
```

#### gl_detail（凭证分录表）

```
表名: gl_detail
业务描述: 凭证分录表（凭证明细），存储凭证的借贷分录。与 gl_voucher 是多对一关系。

关键字段说明:
- pk_detail: 分录主键
- pk_voucher: 关联的凭证主键（外键）
- pk_accsubj: 会计科目主键，关联 bd_accsubj 表
- subjcode: 科目编码
- subjname: 科目名称
- balanorient: 科目方向，0=借方，1=贷方
- debitamount: 原币借方金额
- creditamount: 原币贷方金额
- localdebitamount: 本位币借方金额
- localcreditamount: 本位币贷方金额
- explanation: 摘要
- pk_currtype: 币种主键
- pk_checktype: 结算方式
- checkno: 结算号

注意事项:
- 借贷金额是互斥的，借方有值则贷方为0，反之亦然
- 金额字段可能为 NULL，计算时需用 COALESCE 处理
- 辅助核算信息需关联 gl_freevalue 表
```

#### gl_balance（总账余额表）

```
表名: gl_balance
业务描述: 科目余额表，存储各科目期初、本期发生、期末余额等数据。

关键字段说明:
- pk_org: 组织主键
- pk_accsubj: 科目主键
- cyear: 会计年度
- cmonth: 会计期间
- beginbalance: 期初余额
- monthdebit: 本期借方发生额
- monthcredit: 本期贷方发生额
- yeardebit: 本年累计借方
- yearcredit: 本年累计贷方
- endbalance: 期末余额

计算公式:
- 期末余额 = 期初余额 + 本期借方 - 本期贷方（资产类）
- 期末余额 = 期初余额 - 本期借方 + 本期贷方（负债/权益类）
```

### 3.2 科目与组织表描述

#### bd_accsubj（会计科目表）

```
表名: bd_accsubj
业务描述: 会计科目档案表，存储科目编码、名称、类型等信息。

关键字段说明:
- pk_accsubj: 科目主键
- accsubjcode: 科目编码（如 1001, 1001.01）
- accsubjname: 科目名称
- pk_org: 所属组织
- subjlevel: 科目级次（1=一级科目，2=二级科目，以此类推）
- balanorient: 余额方向（0=借方，1=贷方）
- isskillsubj: 是否启用辅助核算（Y/N）
- asssubj: 辅助项编码组合
- enablestate: 启用状态（1=启用，2=停用）
- isleaf: 是否末级科目（Y=末级，可做账；N=非末级）

注意事项:
- 只有末级科目（isleaf='Y'）才能进行账务处理
- 科目编码层级通过长度或分隔符判断（如 4-2-2 格式）
- 辅助核算科目需关联 bd_accassitem 表
```

#### org_orgs（组织表）

```
表名: org_orgs
业务描述: 组织机构表，存储集团及各级组织信息。

关键字段说明:
- pk_org: 组织主键
- code: 组织编码
- name: 组织名称
- pk_group: 所属集团
- pk_father: 上级组织
- orglevel: 组织层级
- enablestate: 启用状态

注意事项:
- 财务核算通常使用 org_financeorg 表中的财务组织
- 需要关联获取组织的中文名称
```

### 3.3 应收应付表描述

#### ap_paybill（付款单）

```
表名: ap_paybill
业务描述: 付款单主表，记录企业对供应商的付款信息。

关键字段说明:
- pk_paybill: 付款单主键
- pk_org: 付款组织
- billno: 单据编号
- pk_supplier: 供应商主键
- billstatus: 单据状态（1=保存, 2=审核, 3=确认）
- paydate: 付款日期
- payamount: 付款金额
- pk_currtype: 币种
- pk_balatype: 结算方式（现金/银行等）

注意事项:
- 有效付款单需判断 billstatus >= 2（已审核）
- 付款明细需关联 ap_paybill_b 表
```

#### ar_recbill（收款单）

```
表名: ar_recbill
业务描述: 收款单主表，记录企业向客户的收款信息。

关键字段说明:
- pk_recbill: 收款单主键
- pk_org: 收款组织
- billno: 单据编号
- pk_customer: 客户主键
- billstatus: 单据状态
- recdate: 收款日期
- recamount: 收款金额
- pk_currtype: 币种

注意事项:
- 有效收款单需判断 billstatus >= 2（已审核）
- 收款明细需关联 ar_recbill_b 表
```

